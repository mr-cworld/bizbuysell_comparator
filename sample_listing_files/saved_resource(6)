var validationControls,isValid,personEmailAddressIsValidForNewUser,formatPhoneInputMask;$(function(){window.CommunityQnA&&typeof CommunityQnA.SetRegistrationHyperLinkClientID=="function"&&CommunityQnA.SetRegistrationHyperLinkClientID("hlJoinMyBBS");$("#LoginModal").on("shown",function(){$("#txtUserName").focus()});window.Utilities&&Utilities.InitializeMarketingOptOutEmailAddressCheck("txtCreateUserName",["chkBuyerNewsletter"])});validationControls=[{ClientID:"txtFirstName",RequiredField:!1,CustomValidationFunction:function(n){var t=!0;return n.val().trim()!=""&&isNameValid(n.val())?$("#plcInvalidFirstName").hide():(t=!1,$("#plcInvalidFirstName").show()),t}},{ClientID:"txtLastName",RequiredField:!1,CustomValidationFunction:function(n){var t=!0;return n.val().trim()!=""&&isNameValid(n.val())?$("#plcInvalidLastName").hide():(t=!1,$("#plcInvalidLastName").show()),t}},{ClientID:"txtCreateUserName",RequiredField:!1,CustomValidationFunction:function(n){var i=new RegExp(window.EmailRegEx,"g"),t=!0;return n.val()!=""&&(n.val()==""||i.test(n.val()))?$("#plcInvalidContactEmail").hide():(t=!1,$("#plcInvalidContactEmail").show()),t}},{ClientID:"txtCreatePassword",RequiredField:!1,CustomValidationFunction:function(n){var t=!0;return n.val()==""||n.val().length<6?(t=!1,$("#plcInvalidPassword").show()):$("#plcInvalidPassword").hide(),t}}];window.LoginUseExtendedSignupOptions&&(Geo.SetDefaultText({SelectStateText:"Select a State First"}),Geo.LinkStateAndCountyDropDowns(window.LoginModalDropdownLocation,window.LoginModalDropdownCounty),$("#"+window.LoginModalDropdownLocation).change(function(){this.value.indexOf(window.CustomCountryListItemValuePrefix)==0?(window.ClientSideValidationDisableValidationVarName=!0,$("#pCountyLabel").removeClass("required")):(window.ClientSideValidationDisableValidationVarName=!1,$("#pCountyLabel").addClass("required"))}),validationControls.push({ClientID:window.LoginModalDropdownBizType,RequiredField:!1,CustomValidationFunction:function(n){var t=!0;return n.val()==""||n.val()<=0?(t=!1,$("#plcInvalidBusinessCategory").show()):$("#plcInvalidBusinessCategory").hide(),t}},{ClientID:window.LoginModalDropdownLocation,RequiredField:!1,CustomValidationFunction:function(n){var t=!0;return n.val()==""||n.val()<=0?(t=!1,$("#plcInvalidState").show()):$("#plcInvalidState").hide(),t}}));isValid=!0;$("#txtFirstName, #txtLastName, #txtCreatePassword").blur(function(){$(this).val()==""?($(this).addClass("error"),$(this).parent().parent().addClass("error")):($(this).removeClass("error"),$(this).parent().parent().removeClass("error"))});window.LoginUseExtendedSignupOptions&&$("#"+window.LoginModalDropdownBizType+", #"+window.LoginModalDropdownLocation).focusout(function(){$(this).val()==""?($(this).addClass("error"),$(this).parent().parent().addClass("error")):($(this).removeClass("error"),$(this).parent().parent().removeClass("error"))});$("#txtCreateUserName").blur(function(){$(this).val()==""?($(this).addClass("error"),$(this).parent().parent().addClass("error")):($.ajax({url:"/users/Services/Users.asmx/IsPersonEmailValidForNewUser",type:"POST","async":!1,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({emailAddress:$("#txtCreateUserName").val(),password:"",registrationType:0}),success:function(n){n=n||{d:{IsValid:!1,IsExistingUser:!1}};n.hasOwnProperty("d")&&(n=n.d);personEmailAddressIsValidForNewUser=n.IsValid},error:function(){personEmailAddressIsValidForNewUser=!1}}),personEmailAddressIsValidForNewUser?($("#plcInvalidExistingEmail").hide(),isValid&&$("#divCreateAccountValidation").hide(),$(this).removeClass("error"),$(this).parent().parent().removeClass("error")):($(this).addClass("error"),$(this).parent().parent().addClass("error"),$("#plcInvalidExistingEmail").show(),$("#divCreateAccountValidation").show()))});$("#hlModalSignup").click(function(){if(isValid=Validation.ManualValidate(validationControls),isValid&&personEmailAddressIsValidForNewUser){$("#divCreateAccountValidation").hide();var n=0;$("#chkBuyerNewsletter").prop("checked")?n=$("#chkBuyerNewsletter").data("newslettertype"):$("#chkBrokerNewsletter").prop("checked")?n=$("#chkBrokerNewsletter").data("newslettertype"):$("#chkFranchiseNewsletter").prop("checked")?n=$("#chkFranchiseNewsletter").data("newslettertype"):$("#chkSellerNewsletter").prop("checked")&&(n=$("#chkSellerNewsletter").data("newslettertype"));window.LoginUseExtendedSignupOptions?MyBBS.CreateBabkUserAndLogin($("#txtFirstName").val(),$("#txtLastName").val(),$("#txtCreateUserName").val(),$("#txtCreatePassword").val(),$("#txtCreatePhoneNumber").val(),$("#"+window.LoginModalDropdownBizType).val(),$("#"+window.LoginModalDropdownLocation).val(),$("#"+window.LoginModalDropdownCounty).val(),n,window.NewsletterSignupSource,window.SecondarySourceCoBrandingId,$("#ddlMemberRole").val()):MyBBS.CreateUserAndLogin($("#txtFirstName").val(),$("#txtLastName").val(),$("#txtCreateUserName").val(),$("#txtCreatePassword").val(),$("#txtCreatePhoneNumber").val(),n,window.SecondarySourceCoBrandingId,$("#ddlMemberRole").val())}else $("#divCreateAccountValidation").show()});formatPhoneInputMask=function(n,t){var i;if(t||(t=window.event),$.inArray(t.keyCode,[8,16,35,36,37,38,39,40,46])<0)if(n.value.charAt(0)!="+"){i=n.value.replace(/\D/g,"");i.length>14&&(i=i.substring(0,14));switch(i.length){case 14:case 13:case 12:case 11:i=i.substring(0,10)+" x "+i.substring(10);case 10:case 9:case 8:case 7:i=i.substring(0,6)+"-"+i.substring(6);case 6:case 5:case 4:i=i.substring(0,3)+") "+i.substring(3);case 3:case 2:case 1:i="("+i}n.value=i}else n.value="+"+n.value.substring(1).replace(/[^\s\d]/g,"")};$("#txtCreatePhoneNumber").keyup(function(){formatPhoneInputMask(this,event)});$("#hlMemberSignIn, #hlMemberSignIn2").click(function(){$("#LoginModal").removeClass("createaccount");$("#divCreateAccountValidation").hide()});$("#spnCreateNewsletter").click(function(){$("#chkCreateNewsletter").trigger("click")});$("#hlJoinMyBBS, #hlJoinMyBBS2").click(function(){$("#divDisableMyBBSLoginControls").css("display","");($("#plcLoginInvalidData").css("display")!="none"||$("#plcLoginInvalidLogin").css("display")!="none")&&$("#divValidation").css("display","")})